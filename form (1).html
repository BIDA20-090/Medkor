<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <title>Medkor | Registration</title>
    <style>
        div{
            border: 3px solid #f1f1f1;
        }
    </style>
</head>
<body style="text-align: center;">
    <div>
         <div style="margin-left: 20%;margin-right: 20%;margin-top: 5%;margin-bottom: 5px;border-left-width: 10px;border-top-width: 10px;border-right-width: 10px;border-bottom-width: 10px; background-color: #f1f1f1;">
        <img src="images/MedKorM1.png">
        <h2>Log In</h2>
        <input  style = "margin-bottom: 10px;" type="email" id="email" name="email" placeholder="Email" required/><br>
        <input  style= "margin-bottom: 10px;" type="password" id="password" name="password" placeholder="Password" required/><br>
        <button style = "margin-bottom: 10px;" id="loginbutton">Log In</button>
         </div>
    </div>

    <p id="demo"></p>

    
</body>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-analytics.js";
    import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-database.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-auth.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyBfnU1aoVz3K4Y_tCTDHxbelcGPFPvknKc",
      authDomain: "medkor-bcf69.firebaseapp.com",
      databaseURL: "https://medkor-bcf69-default-rtdb.firebaseio.com",
      projectId: "medkor-bcf69",
      storageBucket: "medkor-bcf69.appspot.com",
      messagingSenderId: "374865749332",
      appId: "1:374865749332:web:d7c6efe1068cc1e866d4c1",
      measurementId: "G-WBCKYHY7B3"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const database = getDatabase(app);
    const auth = getAuth();

    loginbutton.addEventListener('click',(e)=>{
    var email = document.getElementById('email').value;
    var password = document.getElementById('password').value;

    signInWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        // Signed in 
        const user = userCredential.user;
         alert('Welcome back! lets get to work :)');
         window.location.replace("home.html");
      })
      .catch((error) => {
        const errorCode = error.code;
        const errorMessage = error.message;

        alert(errorMessage);
        });

    });

    /*const user = auth.currentUser;
    onAuthStateChanged(auth, (user) => {
    if (user) {
        // User is signed in, see docs for a list of available properties
        // https://firebase.google.com/docs/reference/js/firebase.User
        const uid = user.uid;
        //bla bla bla
        // ...
    } else {
        // User is signed out
        // ...
        //bla bla bla
    }
    });

    logout.addEventListener('click',(e)=>{

    signOut(auth).then(() => {
        // Sign-out successful.
        alert('user loged out');
    }).catch((error) => {
        // An error happened.
        const errorCode = error.code;
        const errorMessage = error.message;

            alert(errorMessage);
    });

    });*/

</script>
</html>